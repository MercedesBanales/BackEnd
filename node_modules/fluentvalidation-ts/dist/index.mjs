var i=a=>a==null?!1:Array.isArray(a)?a.filter(e=>i(e)).length>0:typeof a=="object"?Object.keys(a).length>0:a!=null;var m=class{constructor(){this.setCustomErrorMessage=e=>{this.customErrorMessage=e;};this.setWhenCondition=e=>{this.whenCondition=e;};this.setUnlessCondition=e=>{this.unlessCondition=e;};}};var c=class extends m{constructor(l){super();this.validateAsync=async(l,r)=>{if(this.whenCondition!=null&&!this.whenCondition(r)||this.unlessCondition!=null&&this.unlessCondition(r))return null;let s=await this.asyncValueValidator(l,r);return s!=null?this.customErrorMessage||s:null};this.asyncValueValidator=l;}};var h=class extends c{constructor(e){super(async(l,r)=>{if(Array.isArray(e)){for(let t of e)if(typeof t=="function"){if(!await t(l,r))return "Value is not valid"}else if(!await t.predicate(l,r))return typeof t.message=="function"?t.message(l,r):t.message;return null}if(typeof e=="function")return await e(l,r)?null:"Value is not valid";let{predicate:s,message:n}=e;return await s(l,r)?null:typeof n=="function"?n(l,r):n});}};var M=class extends c{constructor(e){super(async(l,r)=>l==null?Promise.resolve(null):await e(r).validateAsync(l));}};var o=class extends m{constructor(l){super();this.validate=(l,r)=>{if(this.whenCondition!=null&&!this.whenCondition(r)||this.unlessCondition!=null&&this.unlessCondition(r))return null;let s=this.valueValidator(l,r);return s!=null?this.customErrorMessage||s:null};this.valueValidator=l;}};var D=/^[a-zA-Z0-9.!#$%&â€™"*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)+$/,A=class extends o{constructor(){super(e=>{if(e==null)return null;if(typeof e!="string")throw new TypeError("A non-string value was passed to the emailAddress rule");return D.test(e)?null:"Not a valid email address"});}};var b=class extends o{constructor(e){super(l=>l===e?null:`Must equal '${e}'`);}};var u=a=>a.toLocaleString(void 0,{maximumFractionDigits:20});var R=class extends o{constructor(e,l){super(r=>{if(r==null)return null;if(typeof r!="number")throw new TypeError("A non-number value was passed to the exclusiveBetween rule");return r>e&&r<l?null:`Value must be between ${u(e)} and ${u(l)} (exclusive)`});}};var g=class extends o{constructor(e){super(l=>{if(l==null)return null;if(typeof l!="number")throw new TypeError("A non-number value was passed to the greaterThanOrEqualTo rule");return l>=e?null:`Value must be greater than or equal to ${u(e)}`});}};var x=class extends o{constructor(e){super(l=>{if(l==null)return null;if(typeof l!="number")throw new TypeError("A non-number value was passed to the greaterThan rule");return l>e?null:`Value must be greater than ${u(e)}`});}};var E=class extends o{constructor(e,l){super(r=>{if(r==null)return null;if(typeof r!="number")throw new TypeError("A non-number value was passed to the inclusiveBetween rule");return r>=e&&r<=l?null:`Value must be between ${u(e)} and ${u(l)} (inclusive)`});}};var w=class extends o{constructor(e,l){super(r=>{if(r==null)return null;if(typeof r!="string")throw new TypeError("A non-string value was passed to the length rule");return r.length>=e&&r.length<=l?null:`Value must be between ${u(e)} and ${u(l)} characters long`});}};var B=class extends o{constructor(e){super(l=>{if(l==null)return null;if(typeof l!="number")throw new TypeError("A non-number value was passed to the lessThanOrEqualTo rule");return l<=e?null:`Value must be less than or equal to ${u(e)}`});}};var v=class extends o{constructor(e){super(l=>{if(l==null)return null;if(typeof l!="number")throw new TypeError("A non-number value was passed to the lessThan rule");return l<e?null:`Value must be less than ${u(e)}`});}};var P=class extends o{constructor(e){super(l=>{if(l==null)return null;if(typeof l!="string")throw new TypeError("A non-string value was passed to the matches rule");return e.test(l)?null:"Value does not match the required pattern"});}};var N=class extends o{constructor(e){super(l=>{if(l==null)return null;if(typeof l!="string")throw new TypeError("A non-string value was passed to the maxLength rule");return l.length<=e?null:`Value must be no more than ${u(e)} characters long`});}};var k=class extends o{constructor(e){super(l=>{if(l==null)return null;if(typeof l!="string")throw new TypeError("A non-string value was passed to the minLength rule");return l.length>=e?null:`Value must be at least ${u(e)} characters long`});}};var q=class extends o{constructor(e){super((l,r)=>{if(Array.isArray(e)){for(let t of e)if(typeof t=="function"){if(!t(l,r))return "Value is not valid"}else if(!t.predicate(l,r))return typeof t.message=="function"?t.message(l,r):t.message;return null}if(typeof e=="function")return e(l,r)?null:"Value is not valid";let{predicate:s,message:n}=e;return s(l,r)?null:typeof n=="function"?n(l,r):n});}};var C=class extends o{constructor(){super(e=>{if(typeof e!="string"){if(e==null)return null;throw new TypeError("A non-string value was passed to the notEmpty rule")}return e.trim().length>0?null:"Value cannot be empty"});}};var $=class extends o{constructor(e){super(l=>l!==e?null:`Must not equal '${e}'`);}};var O=class extends o{constructor(){super(e=>e!=null?null:"Value cannot be null");}};var L=class extends o{constructor(){super(e=>e==null?null:"Value must be null");}};var _=class extends o{constructor(e,l){super(r=>{if(r==null)return null;if(typeof r!="number")throw new TypeError("A non-number value was passed to the scalePrecision rule");return S(l,e).test(r.toString())?null:`Value must not be more than ${l} digits in total, with allowance for ${e} decimals`});}},S=(a,e)=>new RegExp(`^(-)?([0-9]){0,${a-e}}(\\.[0-9]{0,${e}})?$`);var I=class extends o{constructor(e){super((l,r)=>l==null?null:e(r).validate(l));}};var p=class{constructor(e,l){this.rules=[];this.pushRule=e=>{this.rules.push({isAsync:!1,rule:e}),this.rebuildValidate();};this.pushAsyncRule=e=>{this.rules.push({isAsync:!0,rule:e}),this.rebuildValidate();};this.withMessage=e=>(this.getLatestRule().rule.setCustomErrorMessage(e),this.rebuildValidate(),{...this.getAllRules(),when:this.when,unless:this.unless});this.when=(e,l="AppliesToAllValidators")=>{if(l==="AppliesToAllValidators")for(let r of this.rules)r.rule.setWhenCondition(e);else this.getLatestRule().rule.setWhenCondition(e);return this.rebuildValidate(),this.getAllRules()};this.unless=(e,l="AppliesToAllValidators")=>{if(l==="AppliesToAllValidators")for(let r of this.rules)r.rule.setUnlessCondition(e);else this.getLatestRule().rule.setUnlessCondition(e);return this.rebuildValidate(),this.getAllRules()};this.notEqual=e=>{let l=new $(e);return this.pushRule(l),this.getAllRulesAndExtensions()};this.equal=e=>{let l=new b(e);return this.pushRule(l),this.getAllRulesAndExtensions()};this.must=e=>{let l=new q(e);return this.pushRule(l),this.getAllRulesAndExtensions()};this.notNull=()=>{let e=new O;return this.pushRule(e),this.getAllRulesAndExtensions()};this.null=()=>{let e=new L;return this.pushRule(e),this.getAllRulesAndExtensions()};this.notEmpty=()=>{let e=new C;return this.pushRule(e),this.getAllRulesAndExtensions()};this.length=(e,l)=>{let r=new w(e,l);return this.pushRule(r),this.getAllRulesAndExtensions()};this.maxLength=e=>{let l=new N(e);return this.pushRule(l),this.getAllRulesAndExtensions()};this.minLength=e=>{let l=new k(e);return this.pushRule(l),this.getAllRulesAndExtensions()};this.matches=e=>{let l=new P(e);return this.pushRule(l),this.getAllRulesAndExtensions()};this.emailAddress=()=>{let e=new A;return this.pushRule(e),this.getAllRulesAndExtensions()};this.lessThan=e=>{let l=new v(e);return this.pushRule(l),this.getAllRulesAndExtensions()};this.lessThanOrEqualTo=e=>{let l=new B(e);return this.pushRule(l),this.getAllRulesAndExtensions()};this.greaterThan=e=>{let l=new x(e);return this.pushRule(l),this.getAllRulesAndExtensions()};this.greaterThanOrEqualTo=e=>{let l=new g(e);return this.pushRule(l),this.getAllRulesAndExtensions()};this.exclusiveBetween=(e,l)=>{let r=new R(e,l);return this.pushRule(r),this.getAllRulesAndExtensions()};this.inclusiveBetween=(e,l)=>{let r=new E(e,l);return this.pushRule(r),this.getAllRulesAndExtensions()};this.setValidator=e=>{let l=new I(e);return this.pushRule(l),this.getAllRulesAndExtensions()};this.scalePrecision=(e,l)=>{if(l-e<=0)throw new Error("Invalid scale and precision were passed to the scalePrecision rule");let r=new _(e,l);return this.pushRule(r),this.getAllRulesAndExtensions()};this._getAllRules=()=>({notEqual:this.notEqual,equal:this.equal,must:this.must,notNull:this.notNull,null:this.null,notEmpty:this.notEmpty,length:this.length,maxLength:this.maxLength,minLength:this.minLength,matches:this.matches,emailAddress:this.emailAddress,lessThan:this.lessThan,lessThanOrEqualTo:this.lessThanOrEqualTo,greaterThan:this.greaterThan,greaterThanOrEqualTo:this.greaterThanOrEqualTo,exclusiveBetween:this.exclusiveBetween,inclusiveBetween:this.inclusiveBetween,setValidator:this.setValidator,scalePrecision:this.scalePrecision});this.getAllRulesAndExtensions=()=>({...this.getAllRules(),withMessage:this.withMessage,when:this.when,unless:this.unless});this.getLatestRule=()=>this.rules[this.rules.length-1];this.rebuildValidate=e,this.transformValue=l;}};var T=class extends p{constructor(l,r){super(l,r);this.build=()=>async(l,r)=>{let s=this.transformValue(l);for(let n of this.rules){let t=n.isAsync?await n.rule.validateAsync(s,r):n.rule.validate(s,r);if(i(t))return t}return null};this.mustAsync=l=>{let r=new h(l);return this.pushAsyncRule(r),this.getAllRulesAndExtensions()};this.setAsyncValidator=l=>{let r=new M(l);return this.pushAsyncRule(r),this.getAllRulesAndExtensions()};this.getAllRules=()=>({...this._getAllRules(),mustAsync:this.mustAsync,setAsyncValidator:this.setAsyncValidator});}};var y=class{constructor(e,l,r){this.build=()=>async(e,l)=>{if(l[this.propertyName]==null)return null;let r=this.eachAsyncValueValidatorBuilder.build(),s=[];for(let n of e){let t=await r(n,l),d=i(t)?t:null;s.push(d);}return i(s)?s:null};this.getAllRules=()=>this.eachAsyncValueValidatorBuilder.getAllRules();this.eachAsyncValueValidatorBuilder=new T(e,r),this.propertyName=l;}};var V=class extends p{constructor(l,r){super(l,r);this.build=()=>(l,r)=>{let s=this.transformValue(l);for(let n of this.rules){let t=n.rule.validate(s,r);if(i(t))return t}return null};this.getAllRules=()=>({...this._getAllRules()});}};var f=class{constructor(e,l,r){this.build=()=>(e,l)=>{if(e==null||l[this.propertyName]==null)return null;let r=this.eachValueValidatorBuilder.build(),s=e.map(n=>{let t=r(n,l);return i(t)?t:null});return i(s)?s:null};this.getAllRules=()=>this.eachValueValidatorBuilder.getAllRules();this.eachValueValidatorBuilder=new V(e,r),this.propertyName=l;}};var j=class{constructor(e){this.valueValidatorBuildersByPropertyName={};this.asyncValueValidatorBuildersByPropertyName={};this._validate=()=>({});this._validateAsync=async()=>Promise.resolve({});this.rebuildValidate=()=>{this._validate=e=>{let l={};for(let r of Object.keys(this.valueValidatorBuildersByPropertyName)){let s=this.valueValidatorBuildersByPropertyName[r];for(let n of s){let d=n.build()(e[r],e);i(d)&&(l[r]=d);}}return l};};this.rebuildValidateAsync=()=>{this._validateAsync=async e=>{let l={};for(let r of Object.keys(this.asyncValueValidatorBuildersByPropertyName)){let s=this.asyncValueValidatorBuildersByPropertyName[r];for(let n of s){let d=await n.build()(e[r],e);i(d)&&(l[r]=d);}}return l};};this.ruleFor=e=>{if(this._isAsync){let l=new T(this.rebuildValidateAsync,r=>r);return this.asyncValueValidatorBuildersByPropertyName[e]=this.asyncValueValidatorBuildersByPropertyName[e]||[],this.asyncValueValidatorBuildersByPropertyName[e].push(l),l.getAllRules()}else {let l=new V(this.rebuildValidate,r=>r);return this.valueValidatorBuildersByPropertyName[e]=this.valueValidatorBuildersByPropertyName[e]||[],this.valueValidatorBuildersByPropertyName[e].push(l),l.getAllRules()}};this.ruleForTransformed=(e,l)=>{if(this._isAsync){let r=new T(this.rebuildValidateAsync,l);return this.asyncValueValidatorBuildersByPropertyName[e]=this.asyncValueValidatorBuildersByPropertyName[e]||[],this.asyncValueValidatorBuildersByPropertyName[e].push(r),r.getAllRules()}else {let r=new V(this.rebuildValidate,l);return this.valueValidatorBuildersByPropertyName[e]=this.valueValidatorBuildersByPropertyName[e]||[],this.valueValidatorBuildersByPropertyName[e].push(r),r.getAllRules()}};this.ruleForEach=e=>{if(this._isAsync){let l=new y(this.rebuildValidateAsync,e,r=>r);return this.asyncValueValidatorBuildersByPropertyName[e]==null&&(this.asyncValueValidatorBuildersByPropertyName[e]=[]),this.asyncValueValidatorBuildersByPropertyName[e].push(l),l.getAllRules()}else {let l=new f(this.rebuildValidate,e,r=>r);return this.valueValidatorBuildersByPropertyName[e]==null&&(this.valueValidatorBuildersByPropertyName[e]=[]),this.valueValidatorBuildersByPropertyName[e].push(l),l.getAllRules()}};this.ruleForEachTransformed=(e,l)=>{if(this._isAsync){let r=new y(this.rebuildValidateAsync,e,l);return this.asyncValueValidatorBuildersByPropertyName[e]==null&&(this.asyncValueValidatorBuildersByPropertyName[e]=[]),this.asyncValueValidatorBuildersByPropertyName[e].push(r),r.getAllRules()}else {let r=new f(this.rebuildValidate,e,l);return this.valueValidatorBuildersByPropertyName[e]==null&&(this.valueValidatorBuildersByPropertyName[e]=[]),this.valueValidatorBuildersByPropertyName[e].push(r),r.getAllRules()}};this._isAsync=e;}},F=class extends j{constructor(){super(!1);this.validate=l=>this._validate(l);}},z=class extends j{constructor(){super(!0);this.validateAsync=l=>this._validateAsync(l);}};

export { z as AsyncValidator, F as Validator };
//# sourceMappingURL=out.js.map
//# sourceMappingURL=index.mjs.map